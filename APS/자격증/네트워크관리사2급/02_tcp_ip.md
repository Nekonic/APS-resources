# tcp/ip
## 1. tcp/ip
| 계층 | 주요 프로토콜 | 데이터 단위 | 주요 기능 |
| - | - | - | - |
| 응용(Application)	| HTTP, FTP, SMTP, DNS, Telnet, SNMP, DHCP	| 메시지	| 사용자 서비스 제공 |
| 전송(Transport)	| TCP, UDP	| 세그먼트(TCP), 데이터그램(UDP) | 신뢰성, 흐름제어, 오류제어 |
| 인터넷(Internet)	| IP, ICMP, ARP, IGMP	| 패킷	| 라우팅, 주소 지정 |
| 네트워크 인터페이스(Network Interface)	| 이더넷, PPP, FDDI 등	| 프레임	| 물리적 전송, MAC 주소 사용 |


- TCP: 연결형, 신뢰성 보장, 흐름제어, 오류제어, 3-way handshake 사용
- UDP: 비연결형, 빠르지만 신뢰성 없음, 실시간 서비스에 적합


## 2. ip Address
| class | bit | 10 |
| - | - | - |
| A | 0000 | 0 ~ 127 |
| B | 1000 | 128 ~ 191 |
| C | 1100 | 192 ~ 223 |
| D | 1110 | 224 ~ 239 |
| E | 1111 | 240 ~ 255 |

E class일 경우
1110 `0000`(224)
~
1110 `1111`(239)

D class
1111 `0000`(240)
~
1111 `1111`(255)

| class | 사설ip |
| - | - |
| A | 10.0.0.0 ~ 10.255.255.255 |
| B | 172.16.0.0 ~ 172.31.255.255 |
| C | 192.168.0.0 ~ 192.168.255.255 |


## 3. Subnet Mask
서브넷 마스크: 네트워크/호스트 구분, 1은 네트워크, 0은 호스트

| class | subnet mask |
| - | - |
| A | 255.0.0.0 / 8 |
| B | 255.255.0.0 / 16 |
| C | 255.255.255.0 / 24 |

- CIDR 표기법: 슬래시(/) 뒤에 네트워크 비트 수 (예: 192.168.1.0/24)
- 네트워크 ID/브로드캐스트 주소:
    - IP와 서브넷 마스크 AND 연산 → 네트워크 ID, 호스트 비트 모두 1 → 브로드캐스트

### 네트워크 ID
- 같은 네트워크에 속하는 IP 주소들의 공통 부분.
- IP 주소와 서브넷 마스크를 비트 AND 연산하여 구함.

| 192.168.10.34/24 | AND | 192.168.10.0 |
| - | - | - |
| 1100 0000 | 0xFF | 1100 0000 |
| 1010 1000 | 0xFF | 1010 1000 |
| 0000 1010 | 0xFF | 0000 1010 |
| **0010 0010** | **0x00** | **0000 0000** |

### 브로드캐스트 주소
- 해당 네트워크에 속한 모든 호스트에게 데이터를 전송할 때 사용하는 주소.
- 네트워크 ID에서 호스트 부분의 비트를 모두 1로 만든 값.
- 예) 192.168.10.34/24 -> 192.168.10.255

### 계산
```
216.206.64.91 /27

| 1111 1111 | 1111 1111 | 1111 1111 | 1110 0000 |
128 + 64 + 32  = 224
255.255.255.224

2^3  = 8
256 / 8  = 32
0 ~ 31
32 ~ 63
64 ~ 95

ID = 216.206.64.64
Broadcast = 216.206.64.95
```

### 게이트웨이
- **Gateway**는 서로 다른 네트워크(혹은 프로토콜)를 연결해주는 장치 또는 소프트웨어.
- 가장 흔하게는 내부 네트워크와 외부(인터넷) 네트워크를 연결하는 라우터의 역할을 의미함.
- PC의 기본 게이트웨이 설정: 외부 네트워크로 나가는 패킷이 있을 때, 해당 패킷을 전달할 라우터의 IP 주소를 지정.
- 예시: 사내 PC의 기본 게이트웨이 192.168.0.1 → 이 주소로 패킷을 보내면 라우터가 외부로 전달함.
- 정리: 게이트웨이는 "내가 모르는 네트워크로 가는 길목" 역할을 한다고 이해하면 됨.


## 4. IP Routing
- 라우팅: 패킷이 목적지까지 전달되는 경로 결정
- 정적 라우팅: 관리자가 직접 경로 지정
- 동적 라우팅: 라우터가 자동으로 경로 결정 (RIP, OSPF 등)
- 라우터: 네트워크 계층(3계층) 장비, 서로 다른 네트워크 연결
- 게이트웨이: 프로토콜 변환 등 다양한 네트워크 연결

## 5. Packet 분석
- 패킷: 네트워크에서 전송되는 데이터의 기본 단위
- 패킷 구조: 헤더(주소, 제어정보) + 데이터(실제 내용)
- 분석 도구: Wireshark, tcpdump 등
- 패킷 캡처: 네트워크 트래픽을 실시간으로 분석
### 패킷 분할 관련
- **MTU (Maximum Transmission Unit)**: 네트워크에서 전송 가능한 `최대 패킷 크기`
  - 패킷이 MTU보다 크면 분할(Fragmentation) 수행
  - 예: Ethernet MTU = 1500 bytes
- TOS (Type of Service): 패킷 `우선순위` 지정
- TTL (Time-To-Live): 패킷의 생존 시간 (홉 수)


## 6. 기본 프로토콜
- IP: 비연결형, 주소 지정 및 라우팅 담당
- ICMP: 네트워크 진단(핑, 트레이스루트 등), 오류 메시지 전송
  - **주요 Message Type**:
    - 0: Echo Reply (핑 응답)
    - 8: Echo Request (핑 요청)
    - 3: Destination Unreachable
    - 5: Redirect
    - 11: Time Exceeded
    - 13: Timestamp Request
    - 17: Address Mask Request
- ARP: IP ↔ MAC 주소 변환
- RARP: MAC → IP 주소 변환
- IGMP: 멀티캐스트 그룹 관리

## 7. 응용 프로토콜
| 프로토콜    |  용도           |  기본 포트 번호 |
| - | - | - |
| HTTP    |  웹 서비스        |  80 |
| HTTPS   |  보안 웹 서비스     |  443 |
| FTP     |  파일 전송        |  21 (control), 20 (data) |
| SMTP    |  이메일 전송       |  25 |
| POP3    |  이메일 수신       |  110 |
| IMAP    |  이메일 수신(동기화)  |  143 |
| DNS     |  도메인 이름 변환    |  53 |
| DHCP    |  IP 자동 할당     |  67 (server), 68 (client) |
| Telnet  |  원격 접속        |  23 |
| SSH     |  보안 원격 접속     |  22 |
| SNMP    |  네트워크 관리      |  161 (쿼리), 162 (트랩) |

- 웹(80/443)
- 파일(21/20)
- 메일(25/110/143)
- 네트워크(53/67/68)
- 원격(23/22)
- 관리(161/162)

## 8. 기타
- NAT: 사설 IP ↔ 공인 IP 변환, IP 주소 절약
- Unicast/Multicast/Broadcast
    - Unicast: 1:1 통신 (특정 호스트)
    - Multicast: 1:그룹 통신 (특정 그룹)
    - Broadcast: 1:전체 통신 (같은 네트워크 내 모든 호스트)
